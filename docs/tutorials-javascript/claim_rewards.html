<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" >

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Cousine|Inconsolata" rel="stylesheet">
	<link rel="shortcut icon" type="image/png" href="/devportal/favicon.png">

	
	<link rel="stylesheet" href="/devportal/css/style.css">
	<link rel="stylesheet" href="/devportal/css/css/fontawesome-all.min.css">
	<script src="/devportal/js/main.js"></script>
	

	<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>JS: Claim Rewards | Steem Developer</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="JS: Claim Rewards" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Learn how to claim rewards from unclaimed reward balance using Steemconnect as well as client signing method." />
<meta property="og:description" content="Learn how to claim rewards from unclaimed reward balance using Steemconnect as well as client signing method." />
<link rel="canonical" href="https://developers.steem.io/devportal/tutorials-javascript/claim_rewards" />
<meta property="og:url" content="https://developers.steem.io/devportal/tutorials-javascript/claim_rewards" />
<meta property="og:site_name" content="Steem Developer" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-03T12:55:25-05:00" />
<script type="application/ld+json">
{"description":"Learn how to claim rewards from unclaimed reward balance using Steemconnect as well as client signing method.","@type":"BlogPosting","url":"https://developers.steem.io/devportal/tutorials-javascript/claim_rewards","headline":"JS: Claim Rewards","dateModified":"2019-01-03T12:55:25-05:00","datePublished":"2019-01-03T12:55:25-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://developers.steem.io/devportal/tutorials-javascript/claim_rewards"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


	
</head>
<body>
<header>
	<h1>
		<button type="button" class="open-nav" id="open-nav"></button>
		<a href="/devportal/"  class="logo-link"><img src="/devportal/images/logotype_white.svg" height="40" alt="Steem Developer logo"></a>
	</h1>

	
	<form action="/devportal/search/" method="get">
		<input type="text" name="q" id="search-input" placeholder="Search">
		<input type="submit" value="Search" style="display: none;">
	</form>
	

	<div id="sidebar" class="sidebar">
	
	
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/devportal/">
		<h6 class="ctrl-nav-section title">Introduction</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/devportal/#introduction-welcome">Welcome to Steem</a></li>
						
					
				
			
		</ul>
	</section>
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/devportal/quickstart/">
		<h6 class="ctrl-nav-section title">Quickstart</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/devportal/quickstart/#quickstart-choose-library">Choose Library</a></li>
						
					
						
						<li><a href="/devportal/quickstart/#quickstart-steemd-nodes">steemd Nodes</a></li>
						
					
						
						<li><a href="/devportal/quickstart/#quickstart-testnet">Steem Testnet</a></li>
						
					
				
			
		</ul>
	</section>
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/devportal/tutorials/">
		<h6 class="ctrl-nav-section title">Tutorials</h6>
		<ul class="cont-nav-section content">
			
				
					
						<li><a href="/devportal/tutorials/#tutorials-javascript">Javascript</a></li>
					
				
					
						<li><a href="/devportal/tutorials/#tutorials-python">Python</a></li>
					
				
					
						<li><a href="/devportal/tutorials/#tutorials-ruby">Ruby</a></li>
					
				
					
						<li><a href="/devportal/tutorials/#tutorials-recipes">Recipes</a></li>
					
				
			
		</ul>
	</section>
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/devportal/services/">
		<h6 class="ctrl-nav-section title">Services</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/devportal/services/#services-steemit">Steemit.com</a></li>
						
					
						
						<li><a href="/devportal/services/#services-steemconnect">SteemConnect</a></li>
						
					
						
						<li><a href="/devportal/services/#services-jussi">Jussi</a></li>
						
					
						
						<li><a href="/devportal/services/#services-imagehoster">ImageHoster</a></li>
						
					
						
						<li><a href="/devportal/services/#services-sbds">SBDS</a></li>
						
					
				
			
		</ul>
	</section>
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/devportal/apidefinitions/">
		<h6 class="ctrl-nav-section title">Appbase API</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-condenser-api">Condenser Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-account-by-key-api">Account By Key Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-broadcast-ops-comment">Broadcast Ops Comment</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-account-history-api">Account History Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-database-api">Database Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-follow-api">Follow Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-jsonrpc">Jsonrpc</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-market-history-api">Market History Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-network-broadcast-api">Network Broadcast Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-rc-api">Rc Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-reputation-api">Reputation Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-tags-api">Tags Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-block-api">Block Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-transaction-status-api">Transaction Status Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-debug-node-api">Debug Node Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-witness-api">Witness Api</a></li>
						
					
						
						<li><a href="/devportal/apidefinitions/#apidefinitions-broadcast-ops">Broadcast Ops</a></li>
						
					
				
			
		</ul>
	</section>
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/devportal/resources/">
		<h6 class="ctrl-nav-section title">Resources</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/devportal/resources/#resources-overview">Overview</a></li>
						
					
						
						<li><a href="/devportal/resources/#resources-bluepaper">Bluepaper</a></li>
						
					
						
						<li><a href="/devportal/resources/#resources-client-libs">Client Libraries</a></li>
						
					
						
						<li><a href="/devportal/resources/#resources-tools">Tools</a></li>
						
					
						
						<li><a href="/devportal/resources/#resources-whitepaper">Whitepaper</a></li>
						
					
						
						<li><a href="/devportal/resources/#resources-steem-connect-libs">SteemConnect Libs</a></li>
						
					
						
						<li><a href="/devportal/resources/#resources-developeradvocate">Community & Help</a></li>
						
					
				
			
		</ul>
	</section>
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/devportal/glossary/">
		<h6 class="ctrl-nav-section title">Glossary</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/devportal/glossary/#glossary-chain-basics">Chain Basics</a></li>
						
					
						
					
						
						<li><a href="/devportal/glossary/#glossary-governance">Governance</a></li>
						
					
						
						<li><a href="/devportal/glossary/#glossary-transactions">Transactions</a></li>
						
					
						
						<li><a href="/devportal/glossary/#glossary-api">API</a></li>
						
					
						
						<li><a href="/devportal/glossary/#glossary-market">Market</a></li>
						
					
				
			
		</ul>
	</section>
	
</div>


	<!--<p class="copyright">-->
	<!--<a href="https://steemit.com.com/">-->
	<!--steemit-->
	<!--</a>-->
	<!--</p>-->
	<link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet">
</header>
<div class="main" id="top">
	<div class="hero">
		<h1 class="hero__h1">Steem Developer Portal </h1>
		
		<img class="hero__img" src="/devportal/images/hero.png">
		
	</div>
	<section id="tutorials-javascript-claim-rewards" class="row tutorials-javascript-claim-rewards">
	<h3>
		<a id="tutorials-javascript-claim-rewards">
			JS: Claim Rewards
			
		</a>
	</h3>
	
		<span class="description"><p><em>Learn how to claim rewards from unclaimed reward balance using Steemconnect as well as client signing method.</em></p>
</span>
	

	<p><span class="fa-pull-left top-of-tutorial-repo-link"><span class="first-word">Full</span>, runnable src of <a href="https://github.com/steemit/devportal-tutorials-js/tree/master/tutorials/23_claim_rewards">Claim Rewards</a> can be downloaded as part of the <a href="https://github.com/steemit/devportal-tutorials-js">JS tutorials repository</a>.</span>
<br /></p>

<p>This tutorial runs on the main Steem blockchain. And accounts queried are real users with unclaimed balances.</p>

<h2 id="intro">Intro</h2>

<p>This tutorial will show few functions such as querying account by name and getting unclaimed rewards. We are using the <code class="highlighter-rouge">call</code> function provided by the <code class="highlighter-rouge">dsteem</code> library to pull accounts from the Steem blockchain. A simple HTML interface is used to capture the account and its unclaimed balance as well as allowing interactively claim rewards.</p>

<h2 id="steps">Steps</h2>

<ol>
  <li><a href="#app-setup"><strong>App setup</strong></a> Setup <code class="highlighter-rouge">dsteem</code> to use the proper connection and network.</li>
  <li><a href="#search-account"><strong>Search account</strong></a> Get account details after input has account name</li>
  <li><a href="#fill-form"><strong>Fill form</strong></a> Fill form with account reward balances</li>
  <li><a href="#claim-reward"><strong>Claim reward</strong></a> Claim reward with Steemconnect or Client signing options</li>
</ol>

<h4 id="1-app-setup-">1. App setup <a name="app-setup"></a></h4>

<p>Below we have <code class="highlighter-rouge">dsteem</code> pointing to the production network with the proper chainId, addressPrefix, and endpoint. There is a <code class="highlighter-rouge">public/app.js</code> file which holds the Javascript segment of this tutorial. In the first few lines we define the configured library and packages:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">dsteem</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'dsteem'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
<span class="c1">//connect to production server</span>
<span class="nx">opts</span><span class="p">.</span><span class="nx">addressPrefix</span> <span class="o">=</span> <span class="s1">'STM'</span><span class="p">;</span>
<span class="nx">opts</span><span class="p">.</span><span class="nx">chainId</span> <span class="o">=</span>
    <span class="s1">'0000000000000000000000000000000000000000000000000000000000000000'</span><span class="p">;</span>
<span class="c1">//connect to server which is connected to the network/production</span>
<span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dsteem</span><span class="p">.</span><span class="nx">Client</span><span class="p">(</span><span class="s1">'https://api.steemit.com'</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="2-search-account-">2. Search account <a name="search-account"></a></h4>

<p>After account name field is filled with some name, we do automatic search for account by name when input is focused out. HTML input forms can be found in the <code class="highlighter-rouge">index.html</code> file. The values are pulled from that screen with the below:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">const</span> <span class="nx">accSearch</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'username'</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">_accounts</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">database</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">'get_accounts'</span><span class="p">,</span> <span class="p">[[</span><span class="nx">accSearch</span><span class="p">]]);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`_accounts:`</span><span class="p">,</span> <span class="nx">_accounts</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="3-fill-form-">3. Fill form <a name="fill-form"></a></h4>

<p>After we fetched account data, we will fill form with reward balance and show current reward balance details.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">_accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">name</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">reward_steem</span> <span class="o">=</span> <span class="nx">_accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">reward_steem_balance</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
<span class="kd">const</span> <span class="nx">reward_sbd</span> <span class="o">=</span> <span class="nx">_accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">reward_sbd_balance</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
<span class="kd">const</span> <span class="nx">reward_sp</span> <span class="o">=</span> <span class="nx">_accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">reward_vesting_steem</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
<span class="kd">const</span> <span class="nx">reward_vests</span> <span class="o">=</span> <span class="nx">_accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">reward_vesting_balance</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
<span class="kd">const</span> <span class="nx">unclaimed_balance</span> <span class="o">=</span> <span class="s2">`Unclaimed balance for </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">: </span><span class="p">${</span><span class="nx">reward_steem</span><span class="p">}</span><span class="s2"> STEEM, </span><span class="p">${</span><span class="nx">reward_sbd</span><span class="p">}</span><span class="s2"> SBD, </span><span class="p">${</span><span class="nx">reward_sp</span><span class="p">}</span><span class="s2"> SP = </span><span class="p">${</span><span class="nx">reward_vests</span><span class="p">}</span><span class="s2"> VESTS&lt;br/&gt;`</span><span class="p">;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'accList'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">unclaimed_balance</span><span class="p">;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'steem'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">reward_steem</span><span class="p">;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'sbd'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">reward_sbd</span><span class="p">;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'sp'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">reward_vests</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="4-claim-reward-">4. Claim reward <a name="claim-reward"></a></h4>

<p>We have 2 options on how to claim rewards. Steemconnect and Client signing options. We generate Steemconnect link to claim rewards, but you can also choose client signing option to claim rewards right inside tutorial.</p>

<p>In order to enable client signing, we will generate operation and also show Posting Private key (wif) field to sign transaction right there client side.
Below you can see example of operation and signing transaction, after successful operation broadcast result will be shown in user interface. It will be block number that transaction was included.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">window</span><span class="p">.</span><span class="nx">submitTx</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">privateKey</span> <span class="o">=</span> <span class="nx">dsteem</span><span class="p">.</span><span class="nx">PrivateKey</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'wif'</span><span class="p">).</span><span class="nx">value</span>
    <span class="p">);</span>
    <span class="kd">const</span> <span class="nx">op</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">'claim_reward_balance'</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="na">account</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'username'</span><span class="p">).</span><span class="nx">value</span><span class="p">,</span>
            <span class="na">reward_steem</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'steem'</span><span class="p">).</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">' STEEM'</span><span class="p">,</span>
            <span class="na">reward_sbd</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'sbd'</span><span class="p">).</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">' SBD'</span><span class="p">,</span>
            <span class="na">reward_vests</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'sp'</span><span class="p">).</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">' VESTS'</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">];</span>
    <span class="nx">client</span><span class="p">.</span><span class="nx">broadcast</span><span class="p">.</span><span class="nx">sendOperations</span><span class="p">([</span><span class="nx">op</span><span class="p">],</span> <span class="nx">privateKey</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'result'</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">'block'</span><span class="p">;</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span>
                <span class="s1">'result'</span>
            <span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">`&lt;br/&gt;&lt;p&gt;Included in block: </span><span class="p">${</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">block_num</span>
            <span class="p">}</span><span class="s2">&lt;/p&gt;&lt;br/&gt;&lt;br/&gt;`</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Thatâ€™s it!</p>

<h3 id="to-run-this-tutorial">To run this tutorial</h3>

<ol>
  <li>clone this repo</li>
  <li><code class="highlighter-rouge">cd tutorials/21_claim_rewards</code></li>
  <li><code class="highlighter-rouge">npm i</code></li>
  <li><code class="highlighter-rouge">npm run dev-server</code> or <code class="highlighter-rouge">npm run start</code></li>
  <li>After a few moments, the server should be running at <a href="http://localhost:3000/">http://localhost:3000/</a></li>
</ol>

<hr />

</section>

</div>
<div class="footer">
	<a href="#">Back to top</a>
</div>
<script>
    document.getElementById("open-nav").addEventListener("click", function () {
        document.body.classList.toggle("nav-open");
    });
</script>
</body>
</html>


<script src="/devportal/js/adjust.js"></script>

